<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Applying to your own dataset with Merlin Models and NVTabular &mdash; Merlin Models  documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Iterating over Deep Learning Models using Merlin Models" href="03-Exploring-different-models.html" />
    <link rel="prev" title="Getting Started with Merlin Models: Develop a Model for MovieLens" href="01-Getting-started.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Merlin Models
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../README.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models_overview.html">Standard Models: Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="README.html">Example Notebooks</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="README.html#inventory">Inventory</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="01-Getting-started.html">Getting Started with Merlin Models: Develop a Model for MovieLens</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Applying to your own dataset with Merlin Models and NVTabular</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Merlin">Merlin</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Integration-of-NVTabular-and-Merlin-Models">Integration of NVTabular and Merlin Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Understanding-the-Schema-File-and-Structure">Understanding the Schema File and Structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Applying-NVTabular-and-Merlin-Models-to-your-own-dataset.">Applying NVTabular and Merlin Models to your own dataset.</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Conclusion">Conclusion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Next-Steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="03-Exploring-different-models.html">Iterating over Deep Learning Models using Merlin Models</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="README.html#running-the-example-notebooks">Running the Example Notebooks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Merlin Models</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="README.html">Merlin Models Example Notebooks</a> &raquo;</li>
      <li>Applying to your own dataset with Merlin Models and NVTabular</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Copyright 2021 NVIDIA Corporation. All Rights Reserved.
#
# Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# ==============================================================================
</pre></div>
</div>
</div>
<p><img alt="0eeebdba12154603957e7b246dd56c5d" src="http://developer.download.nvidia.com/compute/machine-learning/frameworks/nvidia_logo.png" /></p>
<div class="section" id="Applying-to-your-own-dataset-with-Merlin-Models-and-NVTabular">
<h1>Applying to your own dataset with Merlin Models and NVTabular<a class="headerlink" href="#Applying-to-your-own-dataset-with-Merlin-Models-and-NVTabular" title="Permalink to this headline"></a></h1>
<div class="section" id="Overview">
<h2>Overview<a class="headerlink" href="#Overview" title="Permalink to this headline"></a></h2>
<p>In <a class="reference external" href="01-getting-started.ipynb">01-getting-started.ipynb</a>, we provide a getting started example to train a DLRM model on the MovieLens 1M dataset. In this notebook, we will explore how Merlin Models uses the ETL output from <a class="reference external" href="https://github.com/NVIDIA-Merlin/NVTabular/">NVTabular</a>.</p>
<div class="section" id="Learning-objectives">
<h3>Learning objectives<a class="headerlink" href="#Learning-objectives" title="Permalink to this headline"></a></h3>
<p>This notebook provides details how NVTabular and Merlin Models are linked together. We will discuss the concept of the <code class="docutils literal notranslate"><span class="pre">schema</span></code> file.</p>
</div>
</div>
<div class="section" id="Merlin">
<h2>Merlin<a class="headerlink" href="#Merlin" title="Permalink to this headline"></a></h2>
<p><a class="reference external" href="https://developer.nvidia.com/nvidia-merlin">Merlin</a> is an open-source framework for building large-scale (deep learning) recommender systems. It is designed to support recommender systems end-to-end from ETL to training to deployment on CPU or GPU. Common deep learning frameworks are integrated such as TensorFlow or PyTorch. Its key benefits are the easy-to-use APIs, accelerations with GPU and scaling to multi-GPU or multi-node systems.</p>
<p>Merlin Models and NVTabular are components of Merlin. They are designed to work closely together.</p>
<p><a class="reference external" href="https://github.com/NVIDIA-Merlin/models/">Merlin Models</a> is a library to make it easy for users in industry or academia to train and deploy recommender models with best practices baked into the library. This will let users in industry easily train standard models against their own dataset, getting high performance GPU accelerated models into production. This will also let researchers to build custom models by incorporating standard components of deep learning recommender models, and then
benchmark their new models on example offline datasets.</p>
<p><a class="reference external" href="https://github.com/NVIDIA-Merlin/NVTabular/">NVTabular</a> is a feature engineering and preprocessing library for tabular data that is designed to easily manipulate terabyte scale datasets and train deep learning (DL) based recommender systems. It provides high-level abstraction to simplify code and accelerates computation on the GPU using the RAPIDS Dask-cuDF library.</p>
</div>
<div class="section" id="Integration-of-NVTabular-and-Merlin-Models">
<h2>Integration of NVTabular and Merlin Models<a class="headerlink" href="#Integration-of-NVTabular-and-Merlin-Models" title="Permalink to this headline"></a></h2>
<p><img alt="3540f739c87b47e3be329b6d604ab227" src="../_images/schema.png" /></p>
<p>We take a look on a subsequence of our pipeline. We are interested in the interactions of feature engineering and model training.</p>
<p>If you use NVTabular for feature engineering, in addition to the data, NVTabular will provide a <code class="docutils literal notranslate"><span class="pre">schema</span> <span class="pre">file</span></code> describing the dataset structures. NVTabular will automatically collect statistics and detect some types of <code class="docutils literal notranslate"><span class="pre">Tags</span></code>. For example: - Categorify: Transform categorical columns into continuous integers 0, …, |C| for embedding layers. It collects the cardinality of the embedding table and tags it as categorical. - Normalize: Normalize continuous features. It collects the mean and std of
the feature and tags it as continuous.</p>
<p>Some <code class="docutils literal notranslate"><span class="pre">Tags</span></code> have to be provided manually.</p>
<p>Let’s take a look on the MovieLens 1M example.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import os
import shutil
import pandas as pd
import nvtabular as nvt
from merlin.models.utils.example_utils import workflow_fit_transform
import merlin.io

import merlin.models.tf as mm

from os import path
from nvtabular import ops
from merlin.core.utils import download_file
from merlin.models.data.movielens import get_movielens
from merlin.schema.tags import Tags
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2022-03-25 18:08:06.544710: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-03-25 18:08:07.655653: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 16254 MB memory:  -&gt; device: 0, name: Quadro GV100, pci bus id: 0000:15:00.0, compute capability: 7.0
</pre></div></div>
</div>
<p>We will use the utils function to download, extract and preprocess the dataset.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>train, valid = get_movielens(variant=&quot;ml-1m&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/usr/local/lib/python3.8/dist-packages/cudf/core/dataframe.py:1253: UserWarning: The deep parameter is ignored and is only included for pandas compatibility.
  warnings.warn(
</pre></div></div>
</div>
</div>
<div class="section" id="Understanding-the-Schema-File-and-Structure">
<h2>Understanding the Schema File and Structure<a class="headerlink" href="#Understanding-the-Schema-File-and-Structure" title="Permalink to this headline"></a></h2>
<p>When NVTabular process the data, it will persist the schema as a file to disk. The dataset contains the schema as a property, as well.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">schema</span></code> can be interpreted as a list of features in the dataset, where each element describes the feature. It contains the name, some properties (e.g. statistics) and multiple tags.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>train.schema
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[{&#39;name&#39;: &#39;movieId&#39;, &#39;tags&#39;: {&lt;Tags.CATEGORICAL: &#39;categorical&#39;&gt;, &lt;Tags.ITEM: &#39;item&#39;&gt;, &lt;Tags.ITEM_ID: &#39;item_id&#39;&gt;}, &#39;properties&#39;: {&#39;num_buckets&#39;: None, &#39;freq_threshold&#39;: 0.0, &#39;max_size&#39;: 0.0, &#39;start_index&#39;: 0.0, &#39;cat_path&#39;: &#39;.//categories/unique.movieId.parquet&#39;, &#39;embedding_sizes&#39;: {&#39;cardinality&#39;: 3685.0, &#39;dimension&#39;: 159.0}, &#39;domain&#39;: {&#39;min&#39;: 0, &#39;max&#39;: 3685}}, &#39;dtype&#39;: dtype(&#39;int32&#39;), &#39;is_list&#39;: False, &#39;is_ragged&#39;: False}, {&#39;name&#39;: &#39;userId&#39;, &#39;tags&#39;: {&lt;Tags.USER_ID: &#39;user_id&#39;&gt;, &lt;Tags.CATEGORICAL: &#39;categorical&#39;&gt;, &lt;Tags.USER: &#39;user&#39;&gt;}, &#39;properties&#39;: {&#39;num_buckets&#39;: None, &#39;freq_threshold&#39;: 0.0, &#39;max_size&#39;: 0.0, &#39;start_index&#39;: 0.0, &#39;cat_path&#39;: &#39;.//categories/unique.userId.parquet&#39;, &#39;embedding_sizes&#39;: {&#39;cardinality&#39;: 6041.0, &#39;dimension&#39;: 210.0}, &#39;domain&#39;: {&#39;min&#39;: 0, &#39;max&#39;: 6041}}, &#39;dtype&#39;: dtype(&#39;int32&#39;), &#39;is_list&#39;: False, &#39;is_ragged&#39;: False}, {&#39;name&#39;: &#39;rating_binary&#39;, &#39;tags&#39;: {&lt;Tags.BINARY_CLASSIFICATION: &#39;binary_classification&#39;&gt;, &lt;Tags.TARGET: &#39;target&#39;&gt;}, &#39;properties&#39;: {}, &#39;dtype&#39;: dtype(&#39;int32&#39;), &#39;is_list&#39;: False, &#39;is_ragged&#39;: False}]
</pre></div></div>
</div>
<p>We can select the features by <code class="docutils literal notranslate"><span class="pre">Name</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>train.schema.select_by_name(&quot;userId&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[{&#39;name&#39;: &#39;userId&#39;, &#39;tags&#39;: {&lt;Tags.USER_ID: &#39;user_id&#39;&gt;, &lt;Tags.CATEGORICAL: &#39;categorical&#39;&gt;, &lt;Tags.USER: &#39;user&#39;&gt;}, &#39;properties&#39;: {&#39;num_buckets&#39;: None, &#39;freq_threshold&#39;: 0.0, &#39;max_size&#39;: 0.0, &#39;start_index&#39;: 0.0, &#39;cat_path&#39;: &#39;.//categories/unique.userId.parquet&#39;, &#39;embedding_sizes&#39;: {&#39;cardinality&#39;: 6041.0, &#39;dimension&#39;: 210.0}, &#39;domain&#39;: {&#39;min&#39;: 0, &#39;max&#39;: 6041}}, &#39;dtype&#39;: dtype(&#39;int32&#39;), &#39;is_list&#39;: False, &#39;is_ragged&#39;: False}]
</pre></div></div>
</div>
<p>We can see, that NVTabular set the <code class="docutils literal notranslate"><span class="pre">Tags</span></code> <code class="docutils literal notranslate"><span class="pre">user_id</span></code>, <code class="docutils literal notranslate"><span class="pre">user</span></code> and <code class="docutils literal notranslate"><span class="pre">categorical</span></code>. In additionl, it collected the cardinality of the categorical features <code class="docutils literal notranslate"><span class="pre">6041</span></code>. Merlin Models uses the information to define the embedding table size.</p>
<p>Alternatively, we can select them by <code class="docutils literal notranslate"><span class="pre">Tag</span></code>. We add <code class="docutils literal notranslate"><span class="pre">column_names</span></code> to the object to receive only names without all the additional metadata.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># All categorical features
train.schema.select_by_tag(Tags.CATEGORICAL).column_names
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;movieId&#39;, &#39;userId&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># All continuous features
train.schema.select_by_tag(Tags.CONTINUOUS).column_names
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># All targets
train.schema.select_by_tag(Tags.TARGET).column_names
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;rating_binary&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># All features related to the item
train.schema.select_by_tag(Tags.ITEM).column_names
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;movieId&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># All features related to the user
train.schema.select_by_tag(Tags.USER).column_names
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;userId&#39;]
</pre></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">schema</span></code> is a great way to combine Feature Engineering and Model Training as one end-to-end pipeline. Many popular (deep learning) recommender models define the architecture based on different feature types.</p>
<p>DLRM applies embedding layers to each categorical input feature and applies a MLP (called bottom MLP) to the continuous input features.</p>
<p>Two Tower model applies a MLP (with embedding layers for categorical features) to all item features (called item tower) and another MLP to all user features (called user tower).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">schema</span></code> file contains all required information to build the architecture. If the dataset changes (e.g. more features are added), then the same code can be used to define the same architecture.</p>
</div>
<div class="section" id="Applying-NVTabular-and-Merlin-Models-to-your-own-dataset.">
<h2>Applying NVTabular and Merlin Models to your own dataset.<a class="headerlink" href="#Applying-NVTabular-and-Merlin-Models-to-your-own-dataset." title="Permalink to this headline"></a></h2>
<p>We have a solid understanding of the importance of the schema and how the schema works. Let’s take a look on how to apply it to your own dataset.</p>
<p>The best way is to use <a class="reference external" href="https://github.com/NVIDIA-Merlin/NVTabular/">NVTabular</a> for the feature engineering step. We will look on a minimal example for the MovieLens dataset.</p>
<div class="section" id="Download-and-prepare-the-data">
<h3>Download and prepare the data<a class="headerlink" href="#Download-and-prepare-the-data" title="Permalink to this headline"></a></h3>
<p>We will download the dataset, if it is not already downloaded or cached locally.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>input_path = os.environ.get(&quot;INPUT_DATA_DIR&quot;, os.path.expanduser(&quot;~/merlin-models-data/movielens/&quot;))
name = &quot;ml-1m&quot;
download_file(
    &quot;http://files.grouplens.org/datasets/movielens/ml-1m.zip&quot;,
    os.path.join(input_path, &quot;ml-1m.zip&quot;),
)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
downloading ml-1m.zip: 5.93MB [00:00, 10.6MB/s]
unzipping files: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00&lt;00:00, 39.65files/s]
</pre></div></div>
</div>
<p>We preprocess the dataset and split it into training and validation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>ratings = pd.read_csv(
    os.path.join(input_path, &quot;ml-1m/ratings.dat&quot;),
    sep=&quot;::&quot;,
    names=[&quot;userId&quot;, &quot;movieId&quot;, &quot;rating&quot;, &quot;timestamp&quot;],
)
ratings = ratings.sample(len(ratings), replace=False)

num_valid = int(len(ratings) * 0.2)
train = ratings[:-num_valid]
valid = ratings[-num_valid:]
train.to_parquet(os.path.join(input_path, name, &quot;train.parquet&quot;))
valid.to_parquet(os.path.join(input_path, name, &quot;valid.parquet&quot;))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/tmp/ipykernel_24861/340885424.py:1: ParserWarning: Falling back to the &#39;python&#39; engine because the &#39;c&#39; engine does not support regex separators (separators &gt; 1 char and different from &#39;\s+&#39; are interpreted as regex); you can avoid this warning by specifying engine=&#39;python&#39;.
  ratings = pd.read_csv(
</pre></div></div>
</div>
</div>
<div class="section" id="Feature-Engineering-and-Generating-Schema-File-with-NVTabular">
<h3>Feature Engineering and Generating Schema File with NVTabular<a class="headerlink" href="#Feature-Engineering-and-Generating-Schema-File-with-NVTabular" title="Permalink to this headline"></a></h3>
<p>We use NVTabular to define a feature engineering pipeline.</p>
<p>NVTabular has already implemented multiple transformations, called <code class="docutils literal notranslate"><span class="pre">ops</span></code>. An <code class="docutils literal notranslate"><span class="pre">op</span></code> can be applied to a <code class="docutils literal notranslate"><span class="pre">ColumnGroup</span></code> from an overloaded <code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code> operator. <strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">features</span> <span class="o">=</span> <span class="p">[</span> <span class="n">column_name</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">op1</span> <span class="o">&gt;&gt;</span> <span class="n">op2</span> <span class="o">&gt;&gt;</span> <span class="o">...</span>
</pre></div>
</div>
<p>We need to perform following steps: - Categorify userId and movieId, that the values are continuous integers from 0 … |C| - Transform the rating column to a binary target by using <code class="docutils literal notranslate"><span class="pre">&gt;3</span></code> as <code class="docutils literal notranslate"><span class="pre">1</span></code> and otherwise <code class="docutils literal notranslate"><span class="pre">0</span></code> - Add Tags with <code class="docutils literal notranslate"><span class="pre">ops.AddMetadata</span></code> for <code class="docutils literal notranslate"><span class="pre">item_id</span></code>, <code class="docutils literal notranslate"><span class="pre">user_id</span></code>, <code class="docutils literal notranslate"><span class="pre">item</span></code>, <code class="docutils literal notranslate"><span class="pre">user</span></code> and <code class="docutils literal notranslate"><span class="pre">target</span></code>.</p>
<p>Categorify will transform categorical columns into continuous integers 0, …, |C| for embedding layers. It collects the cardinality of the embedding table and tags it as categorical.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>cat_features = [&quot;userId&quot;, &quot;movieId&quot;] &gt;&gt; ops.Categorify(dtype=&quot;int32&quot;)
</pre></div>
</div>
</div>
<p>The tags for <code class="docutils literal notranslate"><span class="pre">user</span></code>, <code class="docutils literal notranslate"><span class="pre">userId</span></code>, <code class="docutils literal notranslate"><span class="pre">item</span></code> and <code class="docutils literal notranslate"><span class="pre">itemID</span></code> cannot be inferred from the dataset. Therefore, we need to provide them manually during the NVTabular workflow. Actually, the DLRM model does not differentiate between <code class="docutils literal notranslate"><span class="pre">user</span></code> and <code class="docutils literal notranslate"><span class="pre">item</span></code> features. But other architectures, such as the <code class="docutils literal notranslate"><span class="pre">Two</span> <span class="pre">Tower</span> <span class="pre">Model</span></code>, depends on the <code class="docutils literal notranslate"><span class="pre">user</span></code> and <code class="docutils literal notranslate"><span class="pre">item</span></code> feature. We will show how to add them manually in a NVTabular workflow below.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>feats_itemId = cat_features[&quot;movieId&quot;] &gt;&gt; ops.TagAsItemID()
feats_userId = cat_features[&quot;userId&quot;] &gt;&gt; ops.TagAsUserID()
feats_target = (
    nvt.ColumnSelector([&quot;rating&quot;])
    &gt;&gt; ops.LambdaOp(lambda col: (col &gt; 3).astype(&quot;int32&quot;))
    &gt;&gt; ops.AddTags([&quot;binary_classification&quot;, &quot;target&quot;])
    &gt;&gt; nvt.ops.Rename(name=&quot;rating_binary&quot;)
)
output = feats_itemId + feats_userId + feats_target
</pre></div>
</div>
</div>
<p>We apply the workflow to our dataset.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%%time
train_path = os.path.join(input_path, name, &quot;train.parquet&quot;)
valid_path = os.path.join(input_path, name, &quot;valid.parquet&quot;)
output_path = os.path.join(input_path, name)

workflow_fit_transform(output, train_path, valid_path, output_path)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CPU times: user 680 ms, sys: 276 ms, total: 956 ms
Wall time: 993 ms
</pre></div></div>
</div>
</div>
<div class="section" id="Training-a-Recommender-Model-with-Merlin-Models">
<h3>Training a Recommender Model with Merlin Models<a class="headerlink" href="#Training-a-Recommender-Model-with-Merlin-Models" title="Permalink to this headline"></a></h3>
<p>We can load the data as a Merlin Dataset object. The Dataset expect the schema as <code class="docutils literal notranslate"><span class="pre">.pb</span></code> file in the train/valid folder, which NVTabular automatically generates.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>train = merlin.io.Dataset(os.path.join(input_path, name, &quot;train&quot;), engine=&quot;parquet&quot;)
valid = merlin.io.Dataset(os.path.join(input_path, name, &quot;valid&quot;), engine=&quot;parquet&quot;)
</pre></div>
</div>
</div>
<p>We can train and evaluate our model.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>model = mm.DLRMModel(
    train.schema,
    embedding_dim=64,
    bottom_block=mm.MLPBlock([128, 64]),
    top_block=mm.MLPBlock([128, 64, 32]),
    prediction_tasks=mm.BinaryClassificationTask(
        train.schema.select_by_tag(Tags.TARGET).column_names[0]
    ),
)

model.compile(optimizer=&quot;adam&quot;)
model.fit(train, batch_size=1024)
model.evaluate(valid, batch_size=1024)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2022-03-25 18:09:33.123429: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
782/782 [==============================] - 12s 10ms/step - rating_binary/binary_classification_task/precision: 0.7117 - rating_binary/binary_classification_task/recall: 0.8238 - rating_binary/binary_classification_task/binary_accuracy: 0.7068 - rating_binary/binary_classification_task/auc: 0.7685 - loss: 0.5628 - regularization_loss: 0.0000e+00 - total_loss: 0.5628
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2022-03-25 18:09:47.324792: W tensorflow/core/grappler/optimizers/loop_optimizer.cc:907] Skipping loop optimization for Merge node with control input: cond/then/_0/cond/cond/branch_executed/_101
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
196/196 [==============================] - 3s 8ms/step - rating_binary/binary_classification_task/precision: 0.7318 - rating_binary/binary_classification_task/recall: 0.8307 - rating_binary/binary_classification_task/binary_accuracy: 0.7272 - rating_binary/binary_classification_task/auc: 0.7927 - loss: 0.5386 - regularization_loss: 0.0000e+00 - total_loss: 0.5386
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0.7317950129508972,
 0.8306925892829895,
 0.7272159457206726,
 0.7927199006080627,
 0.5734753608703613,
 0.0,
 0.5734753608703613]
</pre></div></div>
</div>
<p>We can take a look on the schema.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>train.schema
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[{&#39;name&#39;: &#39;movieId&#39;, &#39;tags&#39;: {&lt;Tags.CATEGORICAL: &#39;categorical&#39;&gt;, &lt;Tags.ITEM: &#39;item&#39;&gt;, &lt;Tags.ITEM_ID: &#39;item_id&#39;&gt;}, &#39;properties&#39;: {&#39;num_buckets&#39;: None, &#39;freq_threshold&#39;: 0.0, &#39;max_size&#39;: 0.0, &#39;start_index&#39;: 0.0, &#39;cat_path&#39;: &#39;.//categories/unique.movieId.parquet&#39;, &#39;embedding_sizes&#39;: {&#39;cardinality&#39;: 3685.0, &#39;dimension&#39;: 159.0}, &#39;domain&#39;: {&#39;min&#39;: 0, &#39;max&#39;: 3685}}, &#39;dtype&#39;: dtype(&#39;int32&#39;), &#39;is_list&#39;: False, &#39;is_ragged&#39;: False}, {&#39;name&#39;: &#39;userId&#39;, &#39;tags&#39;: {&lt;Tags.CATEGORICAL: &#39;categorical&#39;&gt;, &lt;Tags.USER_ID: &#39;user_id&#39;&gt;, &lt;Tags.USER: &#39;user&#39;&gt;}, &#39;properties&#39;: {&#39;num_buckets&#39;: None, &#39;freq_threshold&#39;: 0.0, &#39;max_size&#39;: 0.0, &#39;start_index&#39;: 0.0, &#39;cat_path&#39;: &#39;.//categories/unique.userId.parquet&#39;, &#39;embedding_sizes&#39;: {&#39;cardinality&#39;: 6041.0, &#39;dimension&#39;: 210.0}, &#39;domain&#39;: {&#39;min&#39;: 0, &#39;max&#39;: 6041}}, &#39;dtype&#39;: dtype(&#39;int32&#39;), &#39;is_list&#39;: False, &#39;is_ragged&#39;: False}, {&#39;name&#39;: &#39;rating_binary&#39;, &#39;tags&#39;: {&lt;Tags.BINARY_CLASSIFICATION: &#39;binary_classification&#39;&gt;, &lt;Tags.TARGET: &#39;target&#39;&gt;}, &#39;properties&#39;: {}, &#39;dtype&#39;: dtype(&#39;int32&#39;), &#39;is_list&#39;: False, &#39;is_ragged&#39;: False}]
</pre></div></div>
</div>
<p>As we prepared only a minimal example, our schema has only tree features <code class="docutils literal notranslate"><span class="pre">movieId</span></code>, <code class="docutils literal notranslate"><span class="pre">userId</span></code> and <code class="docutils literal notranslate"><span class="pre">rating_binary</span></code>.</p>
</div>
</div>
<div class="section" id="Conclusion">
<h2>Conclusion<a class="headerlink" href="#Conclusion" title="Permalink to this headline"></a></h2>
<p>Feature engineering and model training are depending on each other. The <code class="docutils literal notranslate"><span class="pre">schema</span></code> object is a convient way to provide information from the feature engineering step to the model training step. It avoids that the user has to declare the same information mutliple times and prevents errors.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">schema</span></code> defined the dataset schema and characteristics and Merlin Models can create the neural network architecture based on the information.</p>
<p>The dataset features will be <code class="docutils literal notranslate"><span class="pre">tagged</span></code> to indicate which type of feature it represents.</p>
<p>The recommended practice is to use <code class="docutils literal notranslate"><span class="pre">NVTabular</span></code> for feature engineering, which generates a <code class="docutils literal notranslate"><span class="pre">schema</span></code> file. NVTabular can automatically add <code class="docutils literal notranslate"><span class="pre">Tags</span></code> for certrain operations. For example, the output of <code class="docutils literal notranslate"><span class="pre">Categorify</span></code> is always a categorical feature and will be tagged. Similar, the output of <code class="docutils literal notranslate"><span class="pre">Normalize</span></code> is always continuous.</p>
<p>You can take a look on the full example of our util function for MovieLens in our repository.</p>
<p>Alternatively, you can manually create a schema file. We support JSON format for schema files.</p>
</div>
<div class="section" id="Next-Steps">
<h2>Next Steps<a class="headerlink" href="#Next-Steps" title="Permalink to this headline"></a></h2>
<p>In the next notebooks, we will explore multiple ranking models with Merlin Models.</p>
<p>You can learn more about NVTabular, its functionality and suppored ops by visiting our <a class="reference external" href="https://github.com/NVIDIA-Merlin/NVTabular/">github repository</a> or exploring the <a class="reference external" href="https://github.com/NVIDIA-Merlin/NVTabular/tree/main/examples">examples</a>, such as <code class="docutils literal notranslate"><span class="pre">`Getting</span> <span class="pre">Started</span> <span class="pre">MovieLens</span></code> &lt;<a class="reference external" href="https://github.com/NVIDIA-Merlin/NVTabular/blob/main/examples/getting-started-movielens/02-ETL-with-NVTabular.ipynb">https://github.com/NVIDIA-Merlin/NVTabular/blob/main/examples/getting-started-movielens/02-ETL-with-NVTabular.ipynb</a>&gt;`__ or
<code class="docutils literal notranslate"><span class="pre">`Scaling</span> <span class="pre">Criteo</span></code> &lt;<a class="reference external" href="https://github.com/NVIDIA-Merlin/NVTabular/tree/main/examples/scaling-criteo">https://github.com/NVIDIA-Merlin/NVTabular/tree/main/examples/scaling-criteo</a>&gt;`__.</p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="01-Getting-started.html" class="btn btn-neutral float-left" title="Getting Started with Merlin Models: Develop a Model for MovieLens" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="03-Exploring-different-models.html" class="btn btn-neutral float-right" title="Iterating over Deep Learning Models using Merlin Models" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, NVIDIA.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>